# Прогнозирование оттока клиентов.    
### Условия задачи.    
Оператор связи «Ниединогоразрыва.ком» хочет научиться прогнозировать отток клиентов. Если вы обнаружите новых клиентом, которые планируют уходить, то тогда им будут предложены промокоды и специальные условия. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и договоре.      

### Описание услуг.    
Оператор предоставляет два основных типа услуг:      

Стационарную телефонную связь. Возможно подключение телефонного аппарата к нескольким линиям одновременно.      
Интернет. Подключение может быть двух типов: через телефонную линию (DSL, от англ. digital subscriber line, «цифровая абонентская линия») или оптоволоконный кабель (Fiber optic).
Также доступны такие услуги:     

Интернет-безопасность: антивирус (DeviceProtection) и блокировка небезопасных сайтов (OnlineSecurity);     
Выделенная линия технической поддержки (TechSupport);    
Облачное хранилище файлов для резервного копирования данных (OnlineBackup);     
Стриминговое телевидение (StreamingTV) и каталог фильмов (StreamingMovies).      

За услуги клиенты могут платить каждый месяц или заключить договор на 1–2 года. Доступны различные способы расчёта и возможность получения электронного чека.     

### План работ
1) Первым шагом загрузить и подготовить данные для анализа:     
- анализ данных (наличие пропусков, замена пропусков и тд);       
- слияние датасетов (соединяю 4 таблицы в одну) + добавление еще одной фичи - наличие станционнарного телефона;        
- преобразование данных (прямое кодирование).   
    
2) Исследование баланса классов и обучение моделей:      
- разделение данных на выборки + анализ классов;      
- обучение моделей с балансировкой классов;     
- анализ метода балансировки классов при помощи увеличения/уменьшения выборки.     
   
3) Провести финальное тестирование.


### Общие выводы
1) Работа заключалась в следующем: подготовить модель для предсказания оттока клиентов из клиенсткой базы, что было сделано:   
* Было предоставлено 4 базы с различным наполнением (данные контракта клиента, услуга по интернету, услуга по телефону, данные по клиентам).    
* 4 таблицы были проверены на наличие пропущенных значений, в одном из таблицы были выявлены пустые значения - эти строки были удалены (их было всего лишь 11 штук).  
* Для обучения моделей таблицы были соединены в одну общую таблицу.     
2) Категориальные данные в новой таблице были закодированы, а количественные данные были отмасшабированы.     
3) Был проведен анализ различных моделей, подробные результаты моделей представлены в выводе по шагу 2.2.     
4) По обучающим данным лучше всего себя показала модель - логистическая регрессия на данных закодированных прямым методом, но на тестовых данных эта модель показала результат хуже, чем случайный лес. В связи с этим финально лучшая модель - случайный лес.    
Финальный результат - F1 - 0.62 и AUC-ROC - 0.853.   
Самые важные признаки для модели: 'Type', 'TermOfCooperation', 'MonthlyCharges'.    
5) Accuracy финальной модели получилось - 75%, Если мы берем во внимание что дисбаланс классов 1 к 3, наша модель по точности идентична, если мы всем клиентам проставим значение "0"(((.   
